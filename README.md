# Technical Specification

## 1. System Overview

### 1.1 Objective
Design a compact Gridfinity-compatible vertical organizer that supports a mixed loading pattern (front, angled-hanging, and top modules) while maintaining stability and printability.

### 1.2 Standards and Basis
- **Grid System:** Gridfinity standard
- **Pitch:** 42 mm per grid unit

### 1.3 Envelope and Capacity Requirements
- **Total Height:** 179.75 mm (25U)
- **Total Footprint:** 84 mm × 126 mm (2 × 3 Gridfinity units)
- **Maximum Supported Payload:** 200 g total applied load

### 1.4 Intended Build Approaches
- PETG+ additive manufacturing for lightweight usage
- Aluminum CNC (or equivalent rigid fabrication) for high-stability builds

---

## 2. Geometric Dimensions and Architecture

### 2.1 Base Section
- **Depth:** 126 mm (full base length)
- **Height:** 21.00 mm (equivalent to standard 3U vertical bin height)
- **Planform Coverage:** 2 × 3 Gridfinity unit footprint

### 2.2 Primary Structural Chassis (Spine)
- **Structure Type:** Robust C-frame / spine profile
- **Anchor Zone:** Rear-most 42 mm (1 unit) of the base
- **Function:** Carry vertical and off-axis loads generated by hanging and top receptacles

### 2.3 Receptacle Interface Geometry
#### 2.3.1 Base Receptacle
- **Configuration:** Integrated 2 × 2 × 1 Gridfinity
- **Access:** Front-loaded

#### 2.3.2 Hanging Receptacle
- **Configuration:** 2 × 2 × 1 Gridfinity
- **Orientation:** 45° from horizontal plane
- **Use Case:** Angled access while preserving front clearance

#### 2.3.3 Top Receptacle
- **Configuration:** 2 × 1 × 1 Gridfinity modular space
- **Use Case:** Small lightweight modules and quick-access items

---

## 3. Engineering and Manufacturing Requirements

### 3.1 Alignment and Center-of-Gravity Constraints
- The center of the **Top Receptacle** and the center of the **Hanging Receptacle** must lie on the same vertical axis.
- This axis must pass through the center of the **front 2 × 2 baseplate** to optimize center-of-gravity behavior and reduce tipping risk.

### 3.2 Tolerance Specification
- **General dimensional tolerance:** ±0.5 mm
- Applies to all fit-critical surfaces, interface edges, and receptacle boundaries.

### 3.3 Retention Features
- Integrated pockets for Gridfinity-compatible magnets.
- Pocket sizing and depth must prevent loose seating while allowing practical insertion during assembly.


---

## 4. Test Case Scenarios (Physical Validation)

### 4.1 TC-01: Critical Dimensional Verification
**Purpose:** Confirm printed part remains within tolerance on major dimensions.

- **Inputs/Tools:** Calipers, angle gauge
- **Steps:**
  1. Measure overall height, footprint width/depth, base height.
  2. Verify 45° hanging receptacle angle.
  3. Record deviation from nominal.
- **Acceptance Criteria:** All measured values within ±0.5 mm (except angle tolerance as defined by measurement capability).

### 4.2 TC-02: Interface Fitment (Gridfinity Modules)
**Purpose:** Validate receptacle interoperability and insertion usability.

- **Inputs/Tools:** Known-good Gridfinity modules (2×2×1 and 2×1×1)
- **Steps:**
  1. Insert modules into base, hanging, and top receptacles.
  2. Confirm no excessive force is required.
  3. Check seated position and removal behavior.
- **Acceptance Criteria:** Modules fully seat, remain retained in expected orientation, and can be removed without binding.

### 4.3 TC-03: Static Load Capacity
**Purpose:** Confirm payload capacity and structural integrity.

- **Inputs/Tools:** Incremental weights up to 200 g
- **Steps:**
  1. Apply staged load (e.g., 50 g increments) up to 200 g.
  2. Hold at maximum load for 10–30 minutes.
  3. Inspect for permanent deformation or crack initiation.
- **Acceptance Criteria:** No structural failure, no permanent deformation affecting intended function.

### 4.4 TC-04: Stability and Tip Resistance
**Purpose:** Verify center-of-gravity behavior under realistic loading.

- **Inputs/Tools:** Typical module payload distribution
- **Steps:**
  1. Populate base, hanging, and top receptacles with representative items.
  2. Place on flat surface and apply light handling disturbances.
  3. Observe rocking, drift, or tipping tendencies.
- **Acceptance Criteria:** No tipping in nominal use conditions; acceptable stability during light interaction.

---

# 5. Artifact, Revision, Branching, Promotion, and Test Governance Specification (Tentacle)

## 5.1 Purpose and Design Principles

This specification defines how Tentacle print revisions, artifacts, and test evidence SHALL be stored and governed.

Rules:

1. Each published revision SHALL be fully self-contained.
2. Published revisions SHALL be immutable.
3. Revision numbers SHALL be global and strictly increasing.
4. Scope SHALL match the validation performed for that revision.
5. Traceability SHALL be maintained from source → derived artifacts → validation evidence.
6. Parallel experimentation SHALL occur outside the published revision tree.
7. Promotion SHALL be implemented as a new revision. Existing revisions SHALL NOT be edited.
8. Promotion SHALL follow a single fixed path: `physical → online → production`.

---

## 5.2 Definitions

### 5.2.1 Revision

A revision is a frozen, published snapshot of artifacts and, when applicable, test evidence.

### 5.2.2 Published

A revision is published when a folder is created under:

```
output/prints/
```

and populated with the required files for its scope. After publication, it is immutable.

### 5.2.3 Scope

Scope is a per-revision classification defining validation requirements.

Allowed scope values:

| scope       | meaning                                                 | tests directory |
|------------|----------------------------------------------------------|-----------------|
| prototype  | design iteration only                                    | forbidden       |
| physical   | printed and physically evaluated                         | required        |
| online     | digital validation only                                  | required        |
| production | final candidate; must satisfy both physical and online   | required        |

Scope MAY change between revisions. Scope is per revision, not per branch.

### 5.2.4 Strict Purity Rule (Scope Isolation)

A revision SHALL contain only the test evidence required for its own scope:

- `physical` SHALL contain only `tests/physical/` and SHALL NOT contain `tests/online/`.
- `online` SHALL contain only `tests/online/` and SHALL NOT contain `tests/physical/`.
- `production` SHALL contain both `tests/online/` and `tests/physical/`.
- `prototype` SHALL contain no `tests/` directory.

---

## 5.3 Revision Identifier and Global Numbering

### 5.3.1 Revision Identifier Format

```
print-YYYYMMDD-rNN-[scope]
```

Components:

- `YYYYMMDD` SHALL be the publication date (freeze date).
- `rNN` SHALL be the global, strictly increasing revision number.
- `[scope]` SHALL be one of: `prototype`, `physical`, `online`, `production`.

Example:

```
print-20260211-r07-physical
```

### 5.3.2 Global Sequence Requirements

- `rNN` SHALL increment by 1 for each new published revision.
- `rNN` SHALL NEVER reset.
- `rNN` SHALL NEVER be reused.
- Revision numbering SHALL reflect publication order only.

---

## 5.4 Immutability and New Revision Triggers

### 5.4.1 Immutability

Once published:

- Files SHALL NOT be edited.
- Files SHALL NOT be replaced.
- Files SHALL NOT be deleted.
- Test data SHALL NOT be modified.

Any correction requires publishing a new revision.

### 5.4.2 Mandatory New Revision Conditions

A new revision MUST be created if any of the following changes:

- Source content (any file inside `source.zip`)
- Derived artifacts (renders, previews)
- Generated STL (`model.stl`)
- Slicer file (`slicer.3mf`)
- Printer hardware used (physical/production)
- Test results JSON
- Measurements
- Photographs (including retakes)
- Scope designation
- Metadata content

If traceability, reproducibility, or validation changes → new revision.

### 5.4.3 Re-testing Policy

If a previously printed object is re-measured or re-evaluated (even without geometry change), this SHALL be recorded as a new revision.

---

## 5.5 Canonical Folder Structure (Minimal Depth)

All folder and file names SHALL be strict lowercase.

```
output/
  prints/
    print-YYYYMMDD-rNN-[scope]/

      metadata.json

      source/
        source.zip
        render_iso.png
        render_side.png
        preview_iso.png
        preview_side.png

      model.stl              (required for physical/online/production; forbidden for prototype)
      slicer.3mf             (required for physical/production; forbidden for prototype/online)

      tests/                 (forbidden for prototype)

        online/              (required only for online and production)
          result-extract.zip
          online-tests-results.json

        physical/            (required only for physical and production)
          front.jpg
          left.jpg
          right.jpg
          iso.jpg
          top.jpg
          back.jpg
          bottom.jpg
          physical-tests-results.json
```

---

## 5.6 File Requirements by Scope

### 5.6.1 Prototype Scope (`prototype`)

Required:

- `metadata.json`
- `source/source.zip`
- `source/render_iso.png`
- `source/render_side.png`
- `source/preview_iso.png`
- `source/preview_side.png`

Forbidden:

- `model.stl`
- `slicer.3mf`
- `tests/`

---

### 5.6.2 Physical Scope (`physical`)

Required:

- All Prototype-required artifacts
- `model.stl`
- `slicer.3mf`
- `tests/physical/` full photo set
- `tests/physical/physical-tests-results.json`

Forbidden:

- `tests/online/`

---

### 5.6.3 Online Scope (`online`)

Required:

- All Prototype-required artifacts
- `model.stl`
- `tests/online/result-extract.zip`
- `tests/online/online-tests-results.json`

Forbidden:

- `slicer.3mf`
- `tests/physical/`

---

### 5.6.4 Production Scope (`production`)

Required:

- All Prototype-required artifacts
- `model.stl`
- `slicer.3mf`
- `tests/online/result-extract.zip`
- `tests/online/online-tests-results.json`
- `tests/physical/` full photo set
- `tests/physical/physical-tests-results.json`

---

## 5.7 Rendering and Preview Requirements

- `source/render_*.png` SHALL correspond to OpenSCAD F6 renders.
- `source/preview_*.png` SHALL correspond to OpenSCAD F5 previews.

Both categories MUST include:

- `*_iso.png` — isometric view
- `*_side.png` — side view

All four images are mandatory for every revision.

---

## 5.8 STL and Slicer Derivation Rules

### 5.8.1 STL Requirement

- `model.stl` SHALL be required for `physical`, `online`, and `production`.
- `model.stl` SHALL be forbidden for `prototype`.

### 5.8.2 Slicer Requirement

- `slicer.3mf` SHALL be required for `physical` and `production`.
- `slicer.3mf` SHALL be forbidden for `prototype` and `online`.

### 5.8.3 Derivation Constraint

If `slicer.3mf` exists:

- It SHALL be derived from `model.stl`.
- `model.stl` SHALL represent the exact geometry used for slicing.

---

## 5.9 Test Capture Requirements

### 5.9.1 Online Testing

Required files:

- `tests/online/result-extract.zip`
- `tests/online/online-tests-results.json`

Online testing SHALL NOT include physical measurements.

### 5.9.2 Physical Testing

Required files:

- `front.jpg`
- `left.jpg`
- `right.jpg`
- `iso.jpg`
- `top.jpg`
- `back.jpg`
- `bottom.jpg`
- `physical-tests-results.json`

Photo rules:

- Raw captures required.
- Cropping allowed.
- Minor color correction allowed.
- Full set required for all physical revisions, including failures.
- Retakes require new revision.

---

## 5.10 JSON Standards

### 5.10.1 Timestamp Format

All timestamps stored in JSON SHALL be ISO 8601 UTC.

Example:

```
2026-02-12T18:25:43Z
```

### 5.10.2 Schema Versioning

All test result JSON files SHALL include:

```
schema_version
```

Schema changes SHALL increment `schema_version`.

---

## 5.11 metadata.json Requirements

`metadata.json` is mandatory for every revision.

Required fields:

- `revision_id` (string; must match folder name)
- `publication_date_utc` (string; ISO 8601 UTC)
- `scope` (string; one of `prototype`, `physical`, `online`, `production`)
- `previous_revision` (string or null)
- `description` (string)

Additional required promotion fields:

- `promoted_from` (string or null)
- `promotion_reason` (string or null)

No checksum enforcement required.
No deprecation flag required.

---

## 5.12 Source Archive Policy (`source.zip`)

- `source.zip` SHALL contain all files necessary to reproduce the model and derived artifacts.
- Dependencies and assets SHALL be included.
- `source.zip` SHALL be treated as the authoritative source snapshot for that revision.

---

## 5.13 Printer Hardware Rule

If printer hardware changes (even with identical `model.stl` and `slicer.3mf`), a new revision SHALL be published. Printer identity SHALL be recorded in `physical-tests-results.json`.

---

## 5.14 Branching Policy

Parallel experimentation SHALL occur outside:

```
output/prints/
```

Example:

```
work/
  experiment-spine/
  experiment-pivot/
```

Working branches:

- May change freely.
- Are not revision-numbered.
- Are not published artifacts.

Publishing from branches:

1. Assign next global revision number.
2. Create revision folder under `output/prints/`.
3. Copy finalized artifacts into the revision folder.
4. Publish and freeze permanently.

If multiple branches are ready simultaneously, publish them as separate sequential revisions. Publication order defines revision order.

---

## 5.15 Promotion Policy (Single Fixed Path)

Promotion is allowed without repeating prior work, but promotion SHALL always create a new revision.

### 5.15.1 Allowed Promotion Paths (Only)

The only allowed promotion path is:

```
physical → online → production
```

Disallowed paths include (not exhaustive):

- `physical → production` (not allowed)
- `online → physical` (not allowed)
- `prototype → online` (not allowed)
- `prototype → physical` (not defined as promotion; it is a new revision)

### 5.15.2 Promotion Implementation

When promoting:

1. Publish a new revision with the new scope.
2. Copy forward only artifacts permitted by the target scope.
3. Do not copy forbidden test folders (strict purity rule).
4. Record lineage in `metadata.json` using `promoted_from`.

Example path:

```
print-YYYYMMDD-rNN-physical
print-YYYYMMDD-rNN+1-online      (promoted_from = physical revision)
print-YYYYMMDD-rNN+2-production  (promoted_from = online revision)
```

---

## 5.16 Deferred Decisions

Archival policy for working branches is intentionally unspecified.

## Traceability & Revision Governance
- Revision folder format: `output/prints/print-YYYYMMDD-rNN-[scope]/`
- Git tag format: `T-rNN` (global monotonic sequence; tags are never reused)
- Promotion path: `physical -> online -> production` (always creates a new revision)
- `complete.flag` is written last by the Windows publish process and is required before ingestion
- Governance, runbook, ledger, prompts, glossary, and templates are defined in:
  - `docs/devops-strategy.md`
  - `docs/governance-spec.md`
  - `docs/runbook.md`
  - `docs/glossary.md`
  - `ledger/sheet-spec.md`
  - `prompts/publish-script-requirements.md`
  - `prompts/promote-script-requirements.md`
  - `prompts/validate-script-requirements.md`
  - `templates/`
